% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/picpenwls.R
\name{picpenwls}
\alias{picpenwls}
\title{Fit the interval-censored AFT model with linear regression model}
\usage{
picpenwls(
  U,
  V,
  delta,
  x,
  estimation = NULL,
  beta0,
  type = "wls",
  wttype = "KM",
  hlimit = 0.1,
  id = NULL,
  index = NULL,
  nonzero.index = NULL,
  lamb.len = 200,
  maxit = 100,
  tol = 0.01
)
}
\arguments{
\item{U}{left-censoring time, having 0 if left-censored.}

\item{V}{right-censoring time, having \code{Inf} if right-censored.}

\item{delta}{censoring indicator, 1: exactly observed; 2: left-censored; 3: right-censored; 4: interval-censored.}

\item{x}{X matrix of baseline covariates.}

\item{estimation}{estimating method of partly interval censored, if estimation="DR", doubly robust estimator is estimated.}

\item{type}{penalized estimating method, default is "wls", lasso penalized estimating method as "lasso", elasticnet penalized estimating method as "elasticnet", SCAD penalized estimating method as "SCAD"}

\item{wttype}{weight estimating method, default is "KM", Beran's nonparametric KM estimating method as "Beran", and  Ishwaran's random survival forests KM estimating method as "Ishwaran".}

\item{hlimit}{bandwidth value, default is NULL.}

\item{id}{cluster id. If the data does not have clustered structure, set \code{id=NULL}.}

\item{index}{index of cluster weight, default is 1}

\item{nonzero.index}{index of nonzero position, default is NULL.}

\item{lamb.len}{the length of grid of lambdas, default is NULL.}

\item{maxit}{maximum number of iteration for the log-rank estimator, default is 100.}

\item{tol}{tolerance of iteration for the log-rank estimator, default is 1e-3.}
}
\value{
\code{picpenwls} returns a data frame containing at least the following components:
\itemize{
\item \code{coefficients}: regression estimator.
\item \code{se}: standard error estimates for \code{est}.
\item \code{pvalue}: p-value.
\item \code{95\% lower bd}: lower bound of coefficients under 95\% confidence level.
\item \code{95% upper bd}: upper bound of coefficients under 95% confidence level.
}
}
\description{
Fit inverse weighted linear regression with partially interval-censored data
}
\details{
see Kim et al., (2023+) for detailed method explanation.
}
\examples{
\dontrun{
# Simulations
set.seed(111)
n = 200
x1 = runif(n,-1,1)
x2 = rbinom(n,1,0.43)
x = cbind(x1,x2)
T = 2 + x1 + x2 + rnorm(n)
U = (1 - 0.25*x1)*runif(n, -6, 5)
V = U + (1 - 0.1*x2)*runif(n, 6, 20)
U = exp(dplyr::case_when(TRUE ~ T, T>V ~ V, T<U ~ -Inf))
V = exp(dplyr::case_when(TRUE ~ T, T>V ~ Inf, T<U ~ U))
delta = ifelse(U==V, 1, 4)
tau=0.3
picpenwls(U=log(U),V=log(V),delta,x=x,h=0.1,wttype="KM")


# Data example
library(PICBayes)
library(tidyverse)
data("mCRC")
d = with(data.frame(mCRC), data.frame(U = ifelse(y==0,R,L),
                                      V = ifelse(y==2,L,R),
                                      # Cluster weighted data
                                      id=(rep(c(table(SITE)),c(table(SITE)))),
                                      # Treatment arm: 0 = FOLFIRI alone, 1 = Panitumumab + FOLFIRI.
                                      x1= case_when(TRT_C == 0 ~ 0, #Pan et al data
                                                    TRT_C == 1 ~ 1),
                                      # Tumor KRAS mutation status: 0 = wild-type, 1 = mutant.
                                      x2= case_when(KRAS_C == 0 ~ 1,
                                                    KRAS_C == 1 ~ 0),
                                      delta = case_when(IC == 0 ~ 1,
                                                        IC == 1 ~ 0)
));
U=(log(d$U));V=log(d$V); delta=d$delta
x = cbind(d$x1,d$x2); id=d$id;  tau=0.1;
picpenwls(U=U,V=V,delta,x=x,h=0.1,wttype="KM")
}
}
\references{
Beran, R. (1981). Nonparametric Regression with Randomly Censored Survival Data. Technical Report, Univ.California, Berkeley.

Ishwaran, H., U. B. Kogalur, E. H. Blackstone, and M. S. Lauer (2008). Random survival forests. The annals of applied statistics. 2 (3), 841â€“860.

Kim, Y., Choi, S. (2023+). On weighted-least squares regression with partially interval-censored data.

Pan, C. (2021). PICBayes: Bayesian Models for Partly Interval-Censored Data. R package. https://CRAN.R-project.org/package=PICBayes.
}
